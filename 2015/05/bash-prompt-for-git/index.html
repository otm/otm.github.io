<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  

  <title> Bash Prompt for Git  &middot; otm.io </title>

  
  <link rel="stylesheet" href="https://otm.github.io/css/poole.css">
  <link rel="stylesheet" href="https://otm.github.io/css/syntax.css">
  <link rel="stylesheet" href="https://otm.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://otm.github.io/css/prism.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.ico">

  
  <link href="" rel="alternate" type="application/rss+xml" title="otm.io" />

  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

  <link href='http://fonts.googleapis.com/css?family=Raleway:400,300' rel='stylesheet' type='text/css'>

  <script src="//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js"></script>
  <script>
    WebFont.load({
      google: {
        families: ['Raleway']
      }
    });
  </script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-65366004-1', 'auto');
    ga('send', 'pageview');
  </script>

</head>

<body>

  <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1 class="brand"><a href="https://otm.github.io">otm.io</a></h1>
      <p class="lead">
       heeding the code 
      </p>
    </div>



    <ul class="sidebar-nav">
      <li><a href="https://otm.github.io/blog">Posts</a></li>
      
        <li><a href="/about/">About </a></li>
      
      <br/>
      
      <li>Code:</li>
        
          <li><a href="/blade/">Blade </a></li>
        
          <li><a href="/dynaconf/">Dynaconf </a></li>
        
          <li><a href="/sshauth/">sshauth </a></li>
        
      
    </ul>
      
      
      
      <a href="https://github.com/otm"><i class="fa fa-github-square"></i></a>&nbsp;&nbsp;
      <a href="https://plus.google.com/&#43;NilsLagerkvist"><i class="fa fa-google-plus"></i></a>

    <p class="footnote">powered by <a href="http://hugo.spf13.com">Hugo</a> <br/>
    &copy; 2015 Nils Lagerkvist. All rights reserved.</p>

  </div>
</div>


  <div class="content container">
    <div class="post">
    <h1 class="post-title">Bash Prompt for Git</h1>
    <span class="post-date">May 31, 2015</span>
    
    

<p><strong><em>Hacking a bash prompt that adapts when entering a git repository.</em></strong></p>

<div style="background-color: #f2dede; color: #a94442; border-color: #ebccd1; padding: 15px; border: 1px solid transparent; border-radius: 4px; margin-bottom: 1rem; font-size: 0.8rem">
<img src="/images/glyphicons-197-circle-exclamation-mark.png" style="display: inline-block; top: 5px; position: relative; margin: 0px 5px 0 0px" alt="Disclaimer"/>
Disclaimer: This is a 15min hack which might include bugs and can definitely be made more performant.
</div>

<p>This bash hack will keep the normal prompt, and only change it when entering a directory that is tracked by git. In a git repository it will display the basename of the directory and branch. The branch name is colored accordingly:</p>

<div style="background-color: grey; border-radius: 4px; padding: 5px 0 5px 0; margin-bottom: 1rem">
<ul style="margin-bottom: 0">
  <li><span style="color: red">Red</span> - uncommitted working
  <li><span style="color: yellow">Yellow</span> - your brancgh is ahead
  <li><span style="color: green">Green</span> - nothing to commit
  <li><span style="color: #ccaa2b">Ochre</span> - all other statuses
</ul>
</div>

<h3 id="examples:eb94dde80e8e80ab0d0eb195da1d2d24">Examples</h3>

<div style="position:relative">
<pre>
nils@ratchet:~/project$
</pre>
<div style="position: absolute; right: 0; top: 0; background-color: lightgray; padding: 0 5px 0 5px; border-bottom-left-radius: 5px">
Normal Directory
</div>
</div>

<div style="position:relative">
<pre>
[go]<span style="color: red">(master)</span>$
</pre>
<div style="position: absolute; right: 0; top: 0; background-color: lightgray; padding: 0 5px 0 5px; border-bottom-left-radius: 5px">
Non Commited
</div>
</div>

<div style="position:relative">
<pre>
[go]<span style="color: green">(master)</span>$
</pre>
<div style="position: absolute; right: 0; top: 0; background-color: lightgray; padding: 0 5px 0 5px; border-bottom-left-radius: 5px">
Clean
</div>
</div>

<h3 id="code:eb94dde80e8e80ab0d0eb195da1d2d24">Code</h3>

<p>The following code should be included in the <code>.bashrc</code> file</p>

<pre><code class="language-bash">COLOR_RED=&quot;\033[0;31m&quot;
COLOR_YELLOW=&quot;\033[0;33m&quot;
COLOR_GREEN=&quot;\033[0;32m&quot;
COLOR_OCHRE=&quot;\033[38;5;95m&quot;
COLOR_BLUE=&quot;\033[0;34m&quot;
COLOR_WHITE=&quot;\033[0;37m&quot;
COLOR_RESET=&quot;\033[0m&quot;
COLOR_RESET2=&quot;\e[0m&quot;

function git_color {
  local git_status=&quot;$(git status 2&gt; /dev/null)&quot;

  if [[ ! $git_status =~ &quot;working directory clean&quot; ]]; then
    echo -e $COLOR_RED
  elif [[ $git_status =~ &quot;Your branch is ahead of&quot; ]]; then
    echo -e $COLOR_YELLOW
  elif [[ $git_status =~ &quot;nothing to commit&quot; ]]; then
    echo -e $COLOR_GREEN
  else
    echo -e $COLOR_OCHRE
  fi
}

function git_branch {
  local git_status=&quot;$(git status 2&gt; /dev/null)&quot;
  local on_branch=&quot;On branch ([^${IFS}]*)&quot;
  local on_commit=&quot;HEAD detached at ([^${IFS}]*)&quot;

  if [[ $git_status =~ $on_branch ]]; then
    local branch=${BASH_REMATCH[1]}
    echo &quot;($branch)&quot;
  elif [[ $git_status =~ $on_commit ]]; then
    local commit=${BASH_REMATCH[1]}
    echo &quot;($commit)&quot;
  fi
}

function git_dir {
  echo &quot;$(basename `git rev-parse --show-toplevel`)/$(git rev-parse --show-prefix)&quot;
}

PS1='$(git status &amp;&gt; /dev/null || printf &quot;\u@\h:\w\$ &quot;)' # other dir
PS1+='$(git status &amp;&gt; /dev/null &amp;&amp; printf &quot;' # if we are in git dir
PS1+=&quot;\[$COLOR_RESET\]&quot;         # reset color
PS1+=&quot;[\$(git_dir)]&quot;            # get git dir + path
PS1+=&quot;\[\$(git_color)\]&quot;        # colors git status
PS1+=&quot;\$(git_branch)&quot;           # prints current branch
PS1+=&quot;\[$BLUE\]\[$COLOR_RESET2\]\\$ &quot;   # '#' for root, else '$'
PS1+='&quot;)'
export PS1


</code></pre>



    

    <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost") 
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'otm.io';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the comments powered by <a href="http://disqus.com/?ref_noscript">Disqus.</a></noscript>
</div>
</div>

<script src="/js/prism.js"></script>
</body>
</html>
